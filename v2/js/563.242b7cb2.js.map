{"version":3,"file":"js/563.242b7cb2.js","mappings":"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","sources":["webpack://vue2/./src/layout/Index.vue","webpack://vue2/./src/layout/LayoutTabs.vue","webpack://vue2/src/layout/LayoutTabs.vue","webpack://vue2/./src/layout/LayoutTabs.vue?3037","webpack://vue2/./src/layout/LayoutTabs.vue?d840","webpack://vue2/src/layout/Index.vue","webpack://vue2/./src/layout/Index.vue?a053","webpack://vue2/./src/layout/Index.vue?ad13","webpack://vue2/./src/utils/event-bus.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-container',{staticClass:\"layout-container-demo\",staticStyle:{\"height\":\"100vh\"}},[_c('el-aside',{attrs:{\"width\":\"200px\"}},[_c('el-scrollbar',[_c('el-menu',{attrs:{\"router\":\"\"}},_vm._l((_vm.menus),function(menu,index){return _c('el-menu-item',{key:index,attrs:{\"index\":String(index),\"route\":{ path: menu.link }}},[_vm._v(\" \"+_vm._s(menu.title)+\" \")])}),1)],1)],1),_c('el-container',[_c('el-header',{staticStyle:{\"text-align\":\"right\",\"font-size\":\"12px\"}},[_c('layout-tabs')],1),_c('p',{staticStyle:{\"color\":\"#999\",\"padding\":\"0 20px 5px\"}},[_vm._v(\"缓存组件：\"+_vm._s(_vm.caches))]),_c('el-main',{attrs:{\"id\":\"app-main-scroller\"}},[_c('div',{staticStyle:{\"padding\":\"20px\"}},[_c('keep-alive',{attrs:{\"include\":_vm.caches}},[(_vm.isRenderTab)?_c('router-view'):_vm._e()],1)],1)])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"layout-tabs\"},[_c('el-tabs',{attrs:{\"type\":\"border-card\",\"closable\":\"\"},on:{\"tab-click\":_vm.clickTab,\"tab-remove\":_vm.removeTab},model:{value:(_vm.curTabKey),callback:function ($$v) {_vm.curTabKey=$$v},expression:\"curTabKey\"}},_vm._l((_vm.tabs),function(item){return _c('el-tab-pane',{key:item.tabKey,attrs:{\"label\":item.title,\"name\":item.tabKey}},[_c('template',{slot:\"label\"},[_vm._v(_vm._s(item.title)+\" \"),(_vm.curTabKey === item.tabKey)?_c('i',{staticClass:\"el-icon-refresh\",on:{\"click\":function($event){return _vm.refreshTab(item)}}}):_vm._e()])],2)}),1),_c('div',{staticClass:\"close-tabs\",on:{\"click\":_vm.closeOtherTabs}},[_vm._v(\"关闭其他\")])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"layout-tabs\">\n    <el-tabs\n      type=\"border-card\"\n      v-model=\"curTabKey\"\n      closable\n      @tab-click=\"clickTab\"\n      @tab-remove=\"removeTab\">\n      <el-tab-pane\n        v-for=\"item in tabs\"\n        :label=\"item.title\"\n        :name=\"item.tabKey\"\n        :key=\"item.tabKey\">\n        <template slot=\"label\">{{item.title}} <i v-if=\"curTabKey === item.tabKey\" class=\"el-icon-refresh\" @click=\"refreshTab(item)\"></i></template>\n      </el-tab-pane>\n    </el-tabs>\n    <div class=\"close-tabs\" @click=\"closeOtherTabs\">关闭其他</div>\n  </div>\n</template>\n\n<script>\nimport { mapMutations, mapActions } from 'vuex'\nimport EventBus from '@/utils/event-bus'\n\nexport default {\n  name: 'LayoutTabs',\n  props: {\n    // 【根据项目修改】tab页面在路由的第几层，或者说第几层的 router-view 组件（当前项目为第二层）\n    tabRouteViewDepth: {\n      type: Number,\n      default: 2 \n    },\n    // tab页面的key值，从route对象中取，一个key值对应一个tab页面\n    // 默认为matchRoute.path值\n    getTabKey: {\n      type: Function,\n      default: function (routeMatch/* , route */) {\n        return routeMatch.path\n      }\n    },\n    // tab页签的标题，默认从路由meta.title中获取\n    tabTitleKey: {\n      type: String,\n      default: 'title'\n    }\n  },\n  data () {\n    return {\n      tabs: [],\n      curTabKey: ''\n    }\n  },\n  methods: {\n    ...mapActions('cache', [\n      'addCache', \n      'removeCache',\n      'removeCacheEntry'\n    ]),\n    ...mapMutations([\n      'setIsRenderTab'\n    ]),\n    // 切换tab\n    changeCurTab () {\n      // 当前路由信息\n      const { path, query, params, hash, matched } = this.$route\n      // tab标签页路由信息：meta、componentName\n      const routeMatch = matched[this.tabRouteViewDepth - 1]\n      const meta = routeMatch.meta\n      const componentName = routeMatch.components?.default?.name\n      // 获取tab标签页信息：tabKey标签页key值；title-标签页标题；tab-存在的标签页\n      const tabKey = this.getTabKey(routeMatch, this.$route)\n      const title = String(meta[this.tabTitleKey] || '')\n      const tab = this.tabs.find(tab => tab.tabKey === tabKey)\n      \n      if (!tabKey) { // tabKey默认为路由的name值\n        console.warn(`LayoutTabs组件：${path} 路由没有匹配的tab标签页，如有需要请配置tab标签页的key值`)\n        return \n      }\n      \n      // 如果同一tab路径变了（例如路径为 /detail/:id），则清除缓存实例\n      if (tab && tab.path !== path) {\n        this.removeCacheEntry(componentName || '')\n        tab.title = ''\n      }\n      \n      const newTab = {\n        tabKey,\n        title: tab?.title || title,\n        path,\n        params,\n        query,\n        hash,\n        componentName \n      }\n      tab ? Object.assign(tab, newTab) : this.tabs.push(newTab)\n      this.curTabKey = tabKey\n    },\n    // 点击tab\n    clickTab (pane) {\n      if (!pane.index) return\n      \n      const tab = this.tabs[Number(pane.index)]\n      if (tab.path !== this.$route.path) {\n        this.gotoTab(tab)\n      }\n    },\n    // 移除tab\n    async removeTab (tabKey) {\n      // 剩下一个时不能删\n      if (this.tabs.length === 1) return\n      \n      const index = this.tabs.findIndex(tab => tab.tabKey === tabKey)\n      if (index < -1) return \n      \n      const tab = this.tabs[index]\n      this.tabs.splice(index, 1)\n      \n      // 如果删除的是当前tab，则切换到最后一个tab\n      if (tab.tabKey === this.curTabKey) {\n        const lastTab = this.tabs[this.tabs.length - 1]\n        lastTab && this.gotoTab(lastTab)\n      }\n      this.removeCache(tab.componentName || '')\n    },\n    // 跳转tab页面\n    async gotoTab (tab) {\n      await this.$router.push({\n        path: tab.path,\n        query: tab.query,\n        hash: tab.hash\n      })\n    },\n    // 关闭非当前页的所有tab页签\n    closeOtherTabs () {\n      this.tabs\n        .filter(tab => tab.tabKey !== this.curTabKey)\n        .forEach(tab => {\n          this.removeCache(tab.componentName || '')\n        })\n      this.tabs = this.tabs.filter(tab => tab.tabKey === this.curTabKey)\n    },\n    // 刷新当前tab页面\n    async refreshTab (tab) {\n      this.setIsRenderTab(false)\n      await this.removeCacheEntry(tab.componentName)\n      this.setIsRenderTab(true)\n    },\n    // 关闭tab页面，默认关闭当前页\n    async closeLayoutTab (tabKey = this.curTabKey) {\n      const index = this.tabs.findIndex(tab => tab.tabKey === tabKey)\n      if (index > -1) {\n        this.removeCache(this.tabs[index].componentName)\n        this.tabs.splice(index, 1) \n      }\n    },\n    // 设置当前tab的标题\n    setCurTabTitle (title) {\n      const curTab = this.tabs.find(tab => tab.tabKey === this.curTabKey)\n      if (curTab) {\n        curTab.title = title\n      }\n    }\n  },\n  watch: {\n    '$route.path': {\n      handler () {\n        this.changeCurTab()\n      },\n      immediate: true\n    }\n  },\n  created () {\n    // 对外提供的事件：关闭弹窗；设置tab标题\n    EventBus.$on('LayoutTabs:closeTab', (tabKey) => {\n      this.closeLayoutTab(tabKey)\n    })\n    EventBus.$on('LayoutTabs:setTabTitle', (title) => {\n      this.setCurTabTitle(title)\n    })\n  }\n}\n</script>\n\n<style lang='less' scoped>\n:deep(.el-tabs__content) {\n  display: none;\n}\n.layout-tabs {\n  position: relative;\n}\n.close-tabs {\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 12px;\n  cursor: pointer;\n  color: #999;\n}\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LayoutTabs.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./LayoutTabs.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LayoutTabs.vue?vue&type=template&id=6c6f2ba2&scoped=true&\"\nimport script from \"./LayoutTabs.vue?vue&type=script&lang=js&\"\nexport * from \"./LayoutTabs.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LayoutTabs.vue?vue&type=style&index=0&id=6c6f2ba2&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6c6f2ba2\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <el-container class=\"layout-container-demo\" style=\"height: 100vh;\">\n    <el-aside width=\"200px\">\n      <el-scrollbar>\n        <el-menu router>\n          <el-menu-item \n            v-for=\"(menu, index) in menus\" \n            :index=\"String(index)\"\n            :route=\"{ path: menu.link }\"\n            :key=\"index\">\n            {{menu.title}}\n          </el-menu-item>\n        </el-menu>\n      </el-scrollbar>\n    </el-aside>\n\n    <el-container>\n      <el-header style=\"text-align: right; font-size: 12px\">\n        <layout-tabs></layout-tabs>\n      </el-header>\n        \n      <p style=\"color: #999; padding: 0 20px 5px;\">缓存组件：{{caches}}</p>\n      <el-main id=\"app-main-scroller\">\n        <div style=\"padding: 20px;\">\n          <keep-alive :include=\"caches\">\n            <router-view v-if=\"isRenderTab\"></router-view>\n          </keep-alive>\n        </div>\n      </el-main>\n    </el-container>\n  </el-container>\n</template>\n\n<script>\nimport LayoutTabs from './LayoutTabs.vue'\nimport { mapState } from 'vuex'\n\nexport default {\n  components: {\n    LayoutTabs,\n  },\n  data () {\n    return {\n      menus: [\n        {\n          link: '/',\n          title: '首页'\n        },\n        {\n          link: '/article',\n          title: '文章列表'\n        },\n        {\n          link: '/child',\n          title: '多级缓存'\n        },\n        {\n          link: '/KeepScroll',\n          title: '记录滚动位置'\n        }\n      ]\n    }\n  },\n  computed: {\n    ...mapState('cache', ['caches']),\n    ...mapState(['isRenderTab'])\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n:deep(.el-menu-item.is-active) {\n  &:focus {\n    color: #303133;\n    background: transparent !important;\n  }\n  color: #303133;\n}\n.layout-container-demo .el-header {\n  position: relative;\n}\n.layout-container-demo .el-aside {\n  border-right: 1px solid #eee;\n}\n.layout-container-demo .el-menu {\n  border-right: none;\n}\n.layout-container-demo .el-main {\n  padding: 0;\n}\n.layout-container-demo .toolbar {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  right: 20px;\n}\n</style>\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Index.vue?vue&type=template&id=3021c78b&scoped=true&\"\nimport script from \"./Index.vue?vue&type=script&lang=js&\"\nexport * from \"./Index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Index.vue?vue&type=style&index=0&id=3021c78b&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3021c78b\",\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\n\nconst EventBus = new Vue()\nexport default EventBus"],"names":["render","_vm","this","_c","_self","staticClass","staticStyle","attrs","_l","menus","menu","index","key","String","path","link","_v","_s","title","caches","isRenderTab","_e","staticRenderFns","on","clickTab","removeTab","model","value","curTabKey","callback","$$v","expression","tabs","item","tabKey","slot","$event","refreshTab","closeOtherTabs","name","props","tabRouteViewDepth","type","default","getTabKey","tabTitleKey","data","methods","changeCurTab","query","params","hash","matched","console","tab","componentName","lastTab","filter","forEach","setCurTabTitle","curTab","watch","handler","immediate","created","EventBus","component","components","LayoutTabs","computed","Vue"],"sourceRoot":""}