import{d as Q,a as q,u as W,b as X,r as N,c as j,w as Y,e as u,o as r,f as R,g as c,h as o,F as O,i as z,j as f,k as M,t as A,l as Z,m as L,_ as U,n as S,K as ee,p as te}from"./index.2f5049a3.js";import{E as $}from"./event-bus.a1e0b78d.js";const G=Q("layout",{state:()=>({isRenderTab:!0}),actions:{setIsRenderTab(b){this.isRenderTab=b}}}),ae={class:"layout-tabs"},ne=q({__name:"LayoutTabs",props:{tabRouteViewDepth:{type:Number,default:2},getTabKey:{type:Function,default:(b,d)=>b.path},tabTitleKey:{type:String,default:"title"}},setup(b){const d=b,v=W(),T=X(),t=N([]),n=N(""),{removeCacheEntry:C,removeCache:m}=j();G();function E(){var I;const{path:e,query:a,params:l,hash:i,matched:B}=v,h=B[d.tabRouteViewDepth-1],s=h.meta,p=(I=h.components)==null?void 0:I.default,V=(p==null?void 0:p.name)||(p==null?void 0:p.__name),K=d.getTabKey(h,v),J=String(s[d.tabTitleKey]||""),_=t.value.find(P=>P.tabKey===K);if(e==="/_empty")return;if(!K){console.warn(`LayoutTabs\u7EC4\u4EF6\uFF1A${e} \u8DEF\u7531\u6CA1\u6709\u5339\u914D\u7684tab\u6807\u7B7E\u9875\uFF0C\u5982\u6709\u9700\u8981\u8BF7\u914D\u7F6Etab\u6807\u7B7E\u9875\u7684key\u503C`);return}_&&_.path!==e&&(C(V||""),_.title="");const D={tabKey:K,title:(_==null?void 0:_.title)||J,path:e,params:l,query:a,hash:i,componentName:V};_?Object.assign(_,D):t.value.push(D),n.value=K}function F(e){if(!e.index)return;const a=t.value[Number(e.index)];a.tabKey!==n.value&&x(a)}async function k(e){if(t.value.length===1)return;const a=t.value.findIndex(i=>i.tabKey===e);if(a<-1)return;const l=t.value[a];if(t.value.splice(a,1),l.tabKey===n.value){const i=t.value[t.value.length-1];i&&x(i)}m(l.componentName||"")}async function x(e){await T.push({path:e.path,query:e.query,hash:e.hash})}async function g(e){await T.push("/_empty"),m(e.componentName||""),T.go(-1)}function y(){t.value.filter(e=>e.tabKey!==n.value).forEach(e=>{m(e.componentName||"")}),t.value=t.value.filter(e=>e.tabKey===n.value)}async function w(e=n.value){const a=t.value.findIndex(l=>l.tabKey===e);a>-1&&(m(t.value[a].componentName||""),t.value.splice(a,1))}function H(e){const a=t.value.find(l=>l.tabKey===n.value);a&&(a.title=e)}return $.on("LayoutTabs:closeTab",e=>{w(e)}),$.on("LayoutTabs:setTabTitle",e=>{H(e)}),Y(()=>v.path,E,{immediate:!0}),(e,a)=>{const l=u("Refresh"),i=u("el-icon"),B=u("el-tab-pane"),h=u("el-tabs");return r(),R("div",ae,[c(h,{type:"border-card",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value=s),closable:"",onTabClick:F,onTabRemove:k},{default:o(()=>[(r(!0),R(O,null,z(t.value,s=>(r(),f(B,{label:s.title,name:s.tabKey,key:s.tabKey},{label:o(()=>[M(A(s.title)+" ",1),s.tabKey===n.value?(r(),f(i,{key:0,onClick:p=>g(s)},{default:o(()=>[c(l)]),_:2},1032,["onClick"])):Z("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"]),L("div",{class:"close-tabs",onClick:y},"\u5173\u95ED\u5176\u4ED6")])}}});const oe=U(ne,[["__scopeId","data-v-3c6d0d48"]]),ue={style:{color:"#999",padding:"0 20px 5px"}},le={style:{padding:"20px"}},se=q({__name:"Index",setup(b){const{caches:d}=j();G();const v=N([{link:"/",title:"\u9996\u9875"},{link:"/article",title:"\u6587\u7AE0\u5217\u8868"},{link:"/child",title:"\u591A\u7EA7\u7F13\u5B58"},{link:"/KeepScroll",title:"\u8BB0\u5F55\u6EDA\u52A8\u4F4D\u7F6E"}]);return(T,t)=>{const n=u("el-menu-item"),C=u("el-menu"),m=u("el-scrollbar"),E=u("el-aside"),F=u("el-header"),k=u("router-view"),x=u("el-main"),g=u("el-container");return r(),f(g,{class:"layout-container-demo",style:{height:"100vh"}},{default:o(()=>[c(E,{width:"200px"},{default:o(()=>[c(m,null,{default:o(()=>[c(C,{router:""},{default:o(()=>[(r(!0),R(O,null,z(v.value,(y,w)=>(r(),f(n,{index:String(w),route:{path:y.link}},{default:o(()=>[M(A(y.title),1)]),_:2},1032,["index","route"]))),256))]),_:1})]),_:1})]),_:1}),c(g,null,{default:o(()=>[c(F,{style:{"text-align":"right","font-size":"12px"}},{default:o(()=>[c(oe)]),_:1}),L("p",ue,"\u7F13\u5B58\u7EC4\u4EF6\uFF1A"+A(S(d)),1),c(x,{id:"app-main-scroller"},{default:o(()=>[L("div",le,[c(k,null,{default:o(({Component:y})=>[(r(),f(ee,{include:S(d)},[(r(),f(te(y)))],1032,["include"]))]),_:1})])]),_:1})]),_:1})]),_:1})}}});const ie=U(se,[["__scopeId","data-v-44c484b9"]]);export{ie as default};
