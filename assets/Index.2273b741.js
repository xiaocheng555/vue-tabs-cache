import{d as Q,a as q,u as W,b as X,r as R,c as j,w as Y,e as u,o as r,f as N,g as c,h as o,F as O,i as z,j as f,k as M,t as V,l as Z,m as A,_ as U,n as S,K as ee,p as te}from"./index.d57aa5be.js";import{E as $}from"./event-bus.a1e0b78d.js";const G=Q("layout",{state:()=>({isRenderTab:!0}),actions:{setIsRenderTab(b){this.isRenderTab=b}}}),ae={class:"layout-tabs"},ne=q({__name:"LayoutTabs",props:{tabRouteViewDepth:{type:Number,default:2},getTabKey:{type:Function,default:(b,i)=>b.path},tabTitleKey:{type:String,default:"title"}},setup(b){const i=b,h=W(),T=X(),t=R([]),n=R(""),{removeCacheEntry:E,removeCache:m}=j();G();function F(){var I;const{path:e,query:a,params:l,hash:_,matched:K}=h,v=K[i.tabRouteViewDepth-1],s=v.meta,p=(I=v.components)==null?void 0:I.default,D=(p==null?void 0:p.name)||(p==null?void 0:p.__name),C=i.getTabKey(v,h),J=String(s[i.tabTitleKey]||""),d=t.value.find(P=>P.tabKey===C);if(e==="/_empty")return;if(!C){console.warn(`LayoutTabs\u7EC4\u4EF6\uFF1A${e} \u8DEF\u7531\u6CA1\u6709\u5339\u914D\u7684tab\u6807\u7B7E\u9875\uFF0C\u5982\u6709\u9700\u8981\u8BF7\u914D\u7F6Etab\u6807\u7B7E\u9875\u7684key\u503C`);return}d&&d.path!==e&&i.tabRouteViewDepth===K.length&&(E(D||""),d.title="");const L={tabKey:C,title:(d==null?void 0:d.title)||J,path:e,params:l,query:a,hash:_,componentName:D};d?Object.assign(d,L):t.value.push(L),n.value=C}function k(e){if(!e.index)return;const a=t.value[Number(e.index)];a.tabKey!==n.value&&x(a)}async function w(e){if(t.value.length===1)return;const a=t.value.findIndex(_=>_.tabKey===e);if(a<-1)return;const l=t.value[a];if(t.value.splice(a,1),l.tabKey===n.value){const _=t.value[t.value.length-1];_&&x(_)}m(l.componentName||"")}async function x(e){await T.push({path:e.path,query:e.query,hash:e.hash})}async function g(e){await T.push("/_empty"),m(e.componentName||""),T.go(-1)}function y(){t.value.filter(e=>e.tabKey!==n.value).forEach(e=>{m(e.componentName||"")}),t.value=t.value.filter(e=>e.tabKey===n.value)}async function B(e=n.value){const a=t.value.findIndex(l=>l.tabKey===e);a>-1&&(m(t.value[a].componentName||""),t.value.splice(a,1))}function H(e){const a=t.value.find(l=>l.tabKey===n.value);a&&(a.title=e)}return $.on("LayoutTabs:closeTab",e=>{B(e)}),$.on("LayoutTabs:setTabTitle",e=>{H(e)}),Y(()=>h.path,F,{immediate:!0}),(e,a)=>{const l=u("Refresh"),_=u("el-icon"),K=u("el-tab-pane"),v=u("el-tabs");return r(),N("div",ae,[c(v,{type:"border-card",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=s=>n.value=s),closable:"",onTabClick:k,onTabRemove:w},{default:o(()=>[(r(!0),N(O,null,z(t.value,s=>(r(),f(K,{label:s.title,name:s.tabKey,key:s.tabKey},{label:o(()=>[M(V(s.title)+" ",1),s.tabKey===n.value?(r(),f(_,{key:0,onClick:p=>g(s)},{default:o(()=>[c(l)]),_:2},1032,["onClick"])):Z("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"]),A("div",{class:"close-tabs",onClick:y},"\u5173\u95ED\u5176\u4ED6")])}}});const oe=U(ne,[["__scopeId","data-v-6b13b517"]]),ue={style:{color:"#999",padding:"0 20px 5px"}},le={style:{padding:"20px"}},se=q({__name:"Index",setup(b){const{caches:i}=j();G();const h=R([{link:"/",title:"\u9996\u9875"},{link:"/article",title:"\u6587\u7AE0\u5217\u8868"},{link:"/child",title:"\u591A\u7EA7\u7F13\u5B58"},{link:"/KeepScroll",title:"\u8BB0\u5F55\u6EDA\u52A8\u4F4D\u7F6E"}]);return(T,t)=>{const n=u("el-menu-item"),E=u("el-menu"),m=u("el-scrollbar"),F=u("el-aside"),k=u("el-header"),w=u("router-view"),x=u("el-main"),g=u("el-container");return r(),f(g,{class:"layout-container-demo",style:{height:"100vh"}},{default:o(()=>[c(F,{width:"200px"},{default:o(()=>[c(m,null,{default:o(()=>[c(E,{router:""},{default:o(()=>[(r(!0),N(O,null,z(h.value,(y,B)=>(r(),f(n,{index:String(B),route:{path:y.link}},{default:o(()=>[M(V(y.title),1)]),_:2},1032,["index","route"]))),256))]),_:1})]),_:1})]),_:1}),c(g,null,{default:o(()=>[c(k,{style:{"text-align":"right","font-size":"12px"}},{default:o(()=>[c(oe)]),_:1}),A("p",ue,"\u7F13\u5B58\u7EC4\u4EF6\uFF1A"+V(S(i)),1),c(x,{id:"app-main-scroller"},{default:o(()=>[A("div",le,[c(w,null,{default:o(({Component:y})=>[(r(),f(ee,{include:S(i)},[(r(),f(te(y)))],1032,["include"]))]),_:1})])]),_:1})]),_:1})]),_:1})}}});const ie=U(se,[["__scopeId","data-v-44c484b9"]]);export{ie as default};
